<header class="admin-header">
    <h1 class="admin-page-title">Analytics</h1>
    <div class="admin-header-actions">
        <select id="periodFilter" class="form-select">
            <option value="24h">Last 24 Hours</option>
            <option value="7d" selected>Last 7 Days</option>
            <option value="30d">Last 30 Days</option>
            <option value="90d">Last 90 Days</option>
        </select>
        <button type="button" class="btn btn-secondary" id="refreshAnalyticsBtn">
            <i class="fas fa-refresh"></i> Refresh
        </button>
    </div>
</header>

<div class="admin-content">
    <!-- Overview Stats -->
    <div class="stats-grid stats-grid-5">
        <div class="stat-card">
            <div class="stat-icon visitors">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label">Unique Visitors</span>
                <span class="stat-value" id="uniqueVisitors">-</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon pageviews">
                <i class="fas fa-eye"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label">Page Views</span>
                <span class="stat-value" id="pageViews">-</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon revenue">
                <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label">Revenue</span>
                <span class="stat-value" id="revenue">-</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon orders">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label">Orders</span>
                <span class="stat-value" id="orderCount">-</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon conversion">
                <i class="fas fa-percentage"></i>
            </div>
            <div class="stat-info">
                <span class="stat-label">Conversion Rate</span>
                <span class="stat-value" id="conversionRate">-</span>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="analytics-grid">
        <!-- Traffic Chart -->
        <section class="admin-section chart-section">
            <div class="section-header">
                <h3 class="section-title">Traffic Overview</h3>
                <select id="chartMetricFilter" class="form-select form-select-sm">
                    <option value="pageViews">Page Views</option>
                    <option value="productViews">Product Views</option>
                    <option value="addToCarts">Add to Carts</option>
                    <option value="checkouts">Checkouts</option>
                </select>
            </div>
            <div class="chart-container">
                <canvas id="trafficChart"></canvas>
            </div>
        </section>

        <!-- Funnel -->
        <section class="admin-section funnel-section">
            <div class="section-header">
                <h3 class="section-title">Conversion Funnel</h3>
            </div>
            <div class="funnel-container">
                <div class="funnel-step">
                    <div class="funnel-bar" id="funnelPageViews" style="width: 100%"></div>
                    <div class="funnel-info">
                        <span class="funnel-label">Page Views</span>
                        <span class="funnel-value" id="funnelPageViewsValue">-</span>
                    </div>
                </div>
                <div class="funnel-step">
                    <div class="funnel-bar" id="funnelProductViews" style="width: 80%"></div>
                    <div class="funnel-info">
                        <span class="funnel-label">Product Views</span>
                        <span class="funnel-value" id="funnelProductViewsValue">-</span>
                    </div>
                </div>
                <div class="funnel-step">
                    <div class="funnel-bar" id="funnelAddToCarts" style="width: 40%"></div>
                    <div class="funnel-info">
                        <span class="funnel-label">Add to Cart</span>
                        <span class="funnel-value" id="funnelAddToCartsValue">-</span>
                    </div>
                </div>
                <div class="funnel-step">
                    <div class="funnel-bar" id="funnelCheckouts" style="width: 20%"></div>
                    <div class="funnel-info">
                        <span class="funnel-label">Completed Orders</span>
                        <span class="funnel-value" id="funnelCheckoutsValue">-</span>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Second Row -->
    <div class="analytics-grid analytics-grid-3">
        <!-- Traffic Sources -->
        <section class="admin-section">
            <div class="section-header">
                <h3 class="section-title">Traffic Sources</h3>
            </div>
            <div class="chart-container chart-container-sm">
                <canvas id="sourcesChart"></canvas>
            </div>
            <div class="sources-list" id="sourcesList"></div>
        </section>

        <!-- Device Breakdown -->
        <section class="admin-section">
            <div class="section-header">
                <h3 class="section-title">Devices</h3>
            </div>
            <div class="chart-container chart-container-sm">
                <canvas id="devicesChart"></canvas>
            </div>
            <div class="devices-list" id="devicesList"></div>
        </section>

        <!-- Top Searches -->
        <section class="admin-section">
            <div class="section-header">
                <h3 class="section-title">Top Searches</h3>
            </div>
            <div class="searches-list" id="searchesList">
                <div class="loading-state">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>Loading...</span>
                </div>
            </div>
        </section>
    </div>

    <!-- Top Products -->
    <div class="analytics-grid analytics-grid-2">
        <section class="admin-section">
            <div class="section-header">
                <h3 class="section-title">Most Viewed Products</h3>
            </div>
            <div class="table-container">
                <table class="admin-table compact-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Category</th>
                            <th class="text-right">Views</th>
                        </tr>
                    </thead>
                    <tbody id="topViewedProducts">
                        <tr>
                            <td colspan="3" class="loading-state">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Loading...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="admin-section">
            <div class="section-header">
                <h3 class="section-title">Most Added to Cart</h3>
            </div>
            <div class="table-container">
                <table class="admin-table compact-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Category</th>
                            <th class="text-right">Add to Carts</th>
                        </tr>
                    </thead>
                    <tbody id="topAddedToCart">
                        <tr>
                            <td colspan="3" class="loading-state">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Loading...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <!-- Promotion Analytics -->
    <section class="admin-section">
        <div class="section-header">
            <h3 class="section-title">Promotion Performance</h3>
        </div>
        <div class="promo-summary">
            <div class="promo-stat">
                <span class="promo-stat-value" id="totalPromoUses">-</span>
                <span class="promo-stat-label">Total Uses</span>
            </div>
            <div class="promo-stat">
                <span class="promo-stat-value" id="totalDiscountGiven">-</span>
                <span class="promo-stat-label">Total Discounts Given</span>
            </div>
        </div>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Promotion Code</th>
                        <th class="text-right">Uses</th>
                        <th class="text-right">Total Discount</th>
                    </tr>
                </thead>
                <tbody id="promotionAnalytics">
                    <tr>
                        <td colspan="3" class="loading-state">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Loading...</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>
